 var ImageRollerModule = (function() {
    var imgRolling = function(autoRollingClass) {
      var findElement = $('.' + autoRollingClass).find('ul');
      var prev = $('.btn_prev');
      var next = $('.btn_nxt');
      var move = 414;
      var pages = $('.visual_img .item').length;
      var currentPage = 1;
      var clickState = false;
      var isDragging = false;
      var isChanged = false;
      var curX;
      var images = new Array();
      if (pages > 1) {
        findElement.on('mousedown touchstart', function(e) {
          isDragging = true;
          if (e.type == 'touchstart') {
            e = e.originalEvent.touches[0];
          }
          curX = e.clientX - this.offsetLeft;
        });
        findElement.on('mousemove touchmove', function(e) {
          if (isDragging && !isChanged) {

            if (e.type == 'touchmove') {
              e = e.originalEvent.touches[0];
            }
            var dX = e.clientX - curX;
            if (dX > -(currentPage - 1) * move + 30) {
              isDragging = false;
              isChanged = true;
              if (currentPage > 1) {
                currentPage--;
                translate(currentPage);
                return;
              }
            } else if (dX < -(currentPage - 1) * move - 30) {
              isDragging = false;
              isChanged = true;

              if (currentPage < pages) {
                currentPage++;
                translate(currentPage);
                return;
              }
            }

            findElement.css({
              "transform": translateX(dX + "px")
            });
            if (e.type == 'mousemove') {
              e.preventDefault();
            }
          }
        });
        findElement.on('mouseup touchend', function(e) {
          isDragging = false;
          isChanged = false;
          translate(currentPage);
        });
      }
      $('.figure_pagination .num.off span').html(pages);
      prev.on({
        'click': function() {
          if (clickState === false) {
            if (currentPage > 1) {
              currentPage--;
              translate(currentPage);
            }
          }
        }
      });

      next.on({
        'click': function() {
          if (clickState === false) {
            if (currentPage < pages) {
              currentPage++;
              translate(currentPage);
            }
          }
        }
      });

      function translate(page) {
        clickState = true;
        $('.figure_pagination .num:first-child').html(page);
        findElement.animate({
          'left': -(page - 1) * move + 'px'
        }, 'normal', function() {
          clickState = false;
        });
      }
    };
    return {
      imgRolling: imgRolling
    };
  })();

  ImageRollerModule.imgRolling('container_visual');
